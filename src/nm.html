<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' https://nieru.net; style-src 'self' 'unsafe-inline'; script-src 'self' https://nieru.net 'unsafe-inline';"/>
  <title>Electron</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
<hr>
<a href="index.html">スレ一覧</a>
<hr>
名前<br>
<input type="text" id="name" name="name" style="width:50%;" size="14" maxlength="48" value="" required>
<br>
メッセージ(独自タグは手打ちで使用してください)<br>
<textarea style="width:80%;" rows="10" id="message" name="message" required></textarea>
<br>
<input type="submit" id="submit" name="submit" value="投稿">

<script>
    let url_string = window.location.href;
    let url = new URL(url_string);
    let param = url.searchParams.get("threadid");
    console.log(param);

document.getElementById("submit").addEventListener("click", function() {
  const name = document.getElementById("name").value;
  const message = document.getElementById("message").value;

  fetch("https://nieru.net/"+ param +"nm", {
    "headers": {
      "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
      "accept-language": "ja,en-US;q=0.9,en;q=0.8",
      "cache-control": "max-age=0",
      "content-type": "multipart/form-data; boundary=----WebKitFormBoundaryjneWBulFWw9tUTxj",
      "sec-ch-ua": "\"Not_A Brand\";v=\"8\", \"Chromium\";v=\"120\", \"Google Chrome\";v=\"120\"",
      "sec-ch-ua-mobile": "?0",
      "sec-ch-ua-platform": "\"Windows\"",
      "sec-fetch-dest": "document",
      "sec-fetch-mode": "navigate",
      "sec-fetch-site": "same-origin",
      "sec-fetch-user": "?1",
      "upgrade-insecure-requests": "1",
      "origin": "https://nieru.net/",
      "Referer": "https://nieru.net/",
      "Referrer-Policy": "strict-origin-when-cross-origin",
      "User-Agent": "Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Chatpark Unofficial Clients",
    },
    "body": "------WebKitFormBoundaryjneWBulFWw9tUTxj\r\nContent-Disposition: form-data; name=\"name\"\r\n\r\n" + name + "\r\n------WebKitFormBoundaryjneWBulFWw9tUTxj\r\nContent-Disposition: form-data; name=\"usr1\"\r\n\r\n\r\n------WebKitFormBoundaryjneWBulFWw9tUTxj\r\nContent-Disposition: form-data; name=\"message\"\r\n\r\n" + message + "\r\n------WebKitFormBoundaryjneWBulFWw9tUTxj\r\nContent-Disposition: form-data; name=\"submit\"\r\n\r\n投稿\r\n------WebKitFormBoundaryjneWBulFWw9tUTxj\r\nContent-Disposition: form-data; name=\"mail\"\r\n\r\n\r\n------WebKitFormBoundaryjneWBulFWw9tUTxj\r\nContent-Disposition: form-data; name=\"files[]\"; filename=\"\"\r\nContent-Type: application/octet-stream\r\n\r\n\r\n------WebKitFormBoundaryjneWBulFWw9tUTxj\r\nContent-Disposition: form-data; name=\"edit\"\r\n\r\na\r\n------WebKitFormBoundaryjneWBulFWw9tUTxj\r\nContent-Disposition: form-data; name=\"del\"\r\n\r\na\r\n------WebKitFormBoundaryjneWBulFWw9tUTxj\r\nContent-Disposition: form-data; name=\"respass\"\r\n\r\n\r\n------WebKitFormBoundaryjneWBulFWw9tUTxj--\r\n",
    "method": "POST"
  }).then(() => {
    // 投稿が成功したらindexに戻る
    window.location.href = "index.html";
  });
});
</script>
</body>
</html>

